<!DOCTYPE html>
<html>
  <head>
	<meta charset="utf-8">

	<title>Weilin Ma's Portfolio Site</title>
	<link rel="icon" type="image/png" href="/KansoW.github.io/public/images/msr-student-template-favicon.png">

	<link rel="stylesheet" href="/KansoW.github.io/public/stylesheets/style.css">

	<script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
</head>

  <body>

    <div id="wrapper">

      <header>
    <nav>
    	<a href="/KansoW.github.io/"><h1>Weilin Ma's Portfolio</h1></a>
    	<ul>
    		<li><a href="/KansoW.github.io/">Portfolio</a></li>
    		<li><a href="/KansoW.github.io/about/">About</a></li>
    		<li><a href="/KansoW.github.io/contact/">Contact</a></li>
    	</ul>
    </nav>
</header>

      <main class="project">
	<section id="contact-content">
		<img id="project-image" src="https://raw.githubusercontent.com/KansoW/KansoW.github.io/master/public/images/former_front.jpg">
		<h1 id="project-title">Two-wheel Self-balancing Robot</h1>
		<h2 id="project-date">2018-03-26 00:00:00 -0500</h2>

		<h2 id="project-description">Project description</h2>

<h1 id="two-wheel-self_balance-robot-with-arduino"><strong>Two-wheel Self_balance Robot with Arduino</strong></h1>
<h3 id="general-idea"><strong>General Idea</strong></h3>
<h5 id="this-is-a-project-that-combines-classical-ideas-from-other-projects">This is a project that combines classical ideas from other projects.</h5>
<ol>
  <li>The inverse pendulum problem that is often seen in the dynamics and control peojects or courses.</li>
  <li>The Arduino car driving project that is often used as a startup proejcts for learning Arduino.</li>
  <li>The IMU (<em>Inertial Measurement Unit</em>) that is widely used for balancing projects.
    <h5 id="this-project-itself-is-fairly-straight-forward-there-are-many-research-papers-and-technical-blog-found-online-that-tackled-this-problem-successfully-i-am-humble-and-glad-that-i-could-get-some-help-from-these-resources">This project itself is fairly straight forward. There are many research papers and technical blog found online that tackled this problem successfully. I am humble and glad that I could get some help from these resources.</h5>
  </li>
</ol>

<h3 id="materials">Materials</h3>
<h4 id="electrical">Electrical</h4>
<ol>
  <li>Arduino UNO V3 
<img src="https://store-cdn.arduino.cc/usa/catalog/product/cache/1/image/520x330/604a3538c15e081937dbfbd20aa60aad/a/0/a000066_featured.jpg" alt="1" /></li>
  <li>DF Robot L298N Motor Driver
<img src="https://www.dfrobot.com/wiki/images/thumb/c/c5/IGP59861_new.jpg/600px-IGP59861_new.jpg" alt="2" /></li>
  <li>Pololu 20.4:1 Metal Gearmotor 25Dx50L mm LP 12V with 48 CPR Encoder
<img src="https://a.pololu-files.com/picture/0J3799.600x480.jpg?03a71976857bd4e6d447a7cd8817f31c" alt="3" /></li>
  <li>MPU6050 6-axis IMU (accelerometer + gyro)
<img src="https://www.makerlab-electronics.com/my_uploads/2015/05/mpu-6050-1.jpg" alt="4" /></li>
  <li>12V 1600 mAh NiMh Battery</li>
  <li>Mini breadborad</li>
  <li>Jumper wires</li>
  <li>Power cable toggle switch
    <h4 id="mechanical">Mechanical</h4>
  </li>
  <li>Pololu Acrylic Chassis Borads
<img src="https://a.pololu-files.com/picture/0J1573.600x480.jpg?83308509dcd3b4cfda6e51d1ab730d27" alt="1" /></li>
  <li>DF Robot Metal Alluminum Standoffs
<img src="http://image.dfrobot.com/image/cache/data/FIT0064/IMG_1595-450x300.jpg" alt="2" /></li>
  <li>Pololu 80mm dia Wheels
<img src="https://a.pololu-files.com/picture/0J2583.600x480.jpg?074bb6080dfb9b4b2349997803f1aae0" alt="3" /></li>
  <li>Pololu 25mm Metal Gear Brackets</li>
  <li>Polou 4mm Motor Shaft Adapters</li>
</ol>

<h3 id="balancing-control-theory">Balancing Control Theory</h3>
<h4 id="pid">PID:</h4>
<h5 id="pid-control-is-the-most-common-and-eaisest-method-to-control-the-motion-of-the-inverse-penculum-or-the-self-balance-questions">PID control is the most common and eaisest method to control the motion of the <strong><em>Inverse Penculum</em></strong> or the <strong><em>Self-balance</em></strong> questions.</h5>
<h5 id="i-used-the-leaing-angle-as-the-controllable-variable-and-the-linear-pushing-or-pulling-force-as-the-input-the-imu-will-sense-gyro-reading-in-the-x-direction-and-acceleromter-reading-in-the-y-and-z-direction-of-which-the-code-snip-is-shown-below">I used the <strong>leaing angle</strong> as the controllable variable and <strong>the linear pushing or pulling force</strong> as the input. The IMU will sense gyro reading in the <strong>x direction</strong> and acceleromter reading in the <strong>y and z direction</strong>, of which the code snip is shown below:</h5>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="c1">// read acceleration and gyroscope values</span>
  <span class="n">accY</span> <span class="o">=</span> <span class="n">mpu</span><span class="p">.</span><span class="n">getAccelerationY</span><span class="p">();</span>
  <span class="n">accZ</span> <span class="o">=</span> <span class="n">mpu</span><span class="p">.</span><span class="n">getAccelerationZ</span><span class="p">();</span>  
  <span class="n">gyroX</span> <span class="o">=</span> <span class="n">mpu</span><span class="p">.</span><span class="n">getRotationX</span><span class="p">();</span>
</code></pre></div></div>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="c1">// calculate the angle of inclination</span>
  <span class="n">accAngle</span> <span class="o">=</span> <span class="n">atan2</span><span class="p">(</span><span class="n">accY</span><span class="p">,</span> <span class="n">accZ</span><span class="p">)</span><span class="o">*</span><span class="n">RAD_TO_DEG</span><span class="p">;</span>
  <span class="n">gyroRate</span> <span class="o">=</span> <span class="n">map</span><span class="p">(</span><span class="n">gyroX</span><span class="p">,</span> <span class="o">-</span><span class="mi">32768</span><span class="p">,</span> <span class="mi">32767</span><span class="p">,</span> <span class="o">-</span><span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">);</span>
  <span class="n">gyroAngle</span> <span class="o">=</span> <span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="n">gyroRate</span><span class="o">*</span><span class="n">incTime</span><span class="p">;</span>  
  <span class="c1">// with complementary filter filter</span>
  <span class="n">currAngle</span> <span class="o">=</span> <span class="mf">0.999</span><span class="o">*</span><span class="p">(</span><span class="n">prevAngle</span> <span class="o">+</span> <span class="n">gyroAngle</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.001</span><span class="o">*</span><span class="p">(</span><span class="n">accAngle</span><span class="p">);</span>
  <span class="c1">// claculate angle error </span>
  <span class="n">err</span> <span class="o">=</span> <span class="n">currAngle</span> <span class="o">-</span> <span class="n">targetAngle</span><span class="p">;</span>
  <span class="c1">//errSum += err;  </span>
  <span class="c1">//errSum = constrain(errSum, -600, 600);</span>
  <span class="c1">// calculate PWM output with PID </span>
  <span class="c1">//motorPWM = Kp*err + Ki*errSum*incTime + Kd*(currAngle-prevAngle)/incTime;</span>
</code></pre></div></div>

<h4 id="lqr">LQR</h4>

<h3 id="progress">Progress</h3>
<h6 id="as-of-right-now-i-got-the-robot-balancing-with-simple-pid-control-here-are-some-videos-showing-the-results">As of right now, I got the robot balancing with simple PID control. Here are some videos showing the results:</h6>
<h5 id="click-the-images-below-to-be-directed-to-the-videos"><strong>Click the images below to be directed to the videos</strong></h5>
<h6><a href="https://youtu.be/JYqBO8-WjIE"><img src="https://raw.githubusercontent.com/KansoW/KansoW.github.io/master/public/images/former_front.jpg" alt="Simple PID_1" /></a></h6>
<h6 id="-1"><img src="https://youtu.be/JYqBO8-WjIE" alt="Simple PID_2" /></h6>
<h6 id="i-will-update-pictures-later">(I will update pictures later…)</h6>

<h3 id="refrence-and-sources">Refrence and Sources</h3>
<h5 id="1-suhardi--et-al-two-wheeled-balancing-robot-controller-designed-using-pid-faculty-of-electrical-and-electronic-engineering-universiti-tun-hussein-onn-malaysia-jan-2015-pp-139">1. SUHARDI , et al. “<a href="https://pdfs.semanticscholar.org/5a5b/3b44c6456ae231162ce013a8e493dc1bc6db.pdf">TWO-WHEELED BALANCING ROBOT CONTROLLER DESIGNED USING PID.</a>” Faculty of Electrical and Electronic Engineering Universiti Tun Hussein Onn Malaysia, Jan. 2015, pp. 1–39.</h5>
<h5 id="2-stanford-university-ee363-linear-quadratic-regulator-discrete-time-finite-horizon-linear-quadratic-regulator-discrete-time-finite-horizon-jan-2009-pp-132">2. Stanford University EE363. “<a href="https://stanford.edu/class/ee363/lectures/dlqr.pdf">Linear Quadratic Regulator: Discrete-Time Finite Horizon.</a>” Linear Quadratic Regulator: Discrete-Time Finite Horizon, Jan. 2009, pp. 1–32.()</h5>
<h5 id="3-cds-110b-lecture-2--lqr-control-california-institute-of-technology-control-and-dynamical-systems-11-jan-2006-pp-114">3. CDS 110b. “<a href="https://www.cds.caltech.edu/~murray/courses/cds110/wi06/lqr.pdf">Lecture 2 – LQR Control</a>.” CALIFORNIA INSTITUTE OF TECHNOLOGY Control and Dynamical Systems, 11 Jan. 2006, pp. 1–14.</h5>
<h5 id="4-df-robot-md13-2a-dual-motor-controller-sku-dri0002">4. <a href="https://www.dfrobot.com/wiki/index.php/MD1.3_2A_Dual_Motor_Controller_SKU_DRI0002">DF Robot MD1.3 2A Dual Motor Controller SKU DRI0002</a></h5>
<h5 id="5-pololu-2041-metal-gearmotor-25dx50l-mm-lp-12v-with-48-cpr-encoder">5. <a href="https://www.pololu.com/product/3263">Pololu 20.4:1 Metal Gearmotor 25Dx50L mm LP 12V with 48 CPR Encoder</a></h5>
<h5 id="6-instructables-arduino-self-balancing-robot">6. <a href="https://www.instructables.com/id/Arduino-Self-Balancing-Robot-1/">Instructables ARDUINO SELF-BALANCING ROBOT</a></h5>
<h5 id="7-mpu-6050-auto-calibration">7. <a href="http://42bots.com/tutorials/arduino-script-for-mpu-6050-auto-calibration/">MPU-6050 auto-calibration</a></h5>
<h5 id="8-hc-06-bluetooth-module-datasheet-and-configuration-with-arduino">8. [HC-06 Bluetooth module datasheet and configuration with Arduino</h5>
<p>](http://42bots.com/tutorials/hc-06-bluetooth-module-datasheet-and-configuration-with-arduino/)</p>
<h5 id="9-wolfram-blog-stabilized-inverted-pendulum">9. <a href="http://blog.wolfram.com/2011/01/19/stabilized-inverted-pendulum/">WOLFRAM BLOG Stabilized Inverted Pendulum</a></h5>
<h5 id="10-stages-of-development-of-the-robot-balancer">10. <a href="http://spin7ion.ru/ru/blog/balancerBuildSteps">Stages of development of the robot-balancer</a></h5>



	</section>

</main>

      <footer>
    <ul>
    	<li>weilinma2018@u.northwestern.edu</li>
    	<li>1510 Dempster St., Evanston, IL, 60202</li>
    	<li>(814)777-5009</li>
    </ul>
</footer>



    </div>

  </body>
</html>